
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.5">
    
    
      
        <title>Appendix - Intel® SecL-DC</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.75751829.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#appendix" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="Intel® SecL-DC" class="md-header-nav__button md-logo" aria-label="Intel® SecL-DC">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Intel® SecL-DC
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Appendix
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://raghav19.github.io/docs" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    intel-secl/intel-secl
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Intel® SecL-DC" class="md-nav__button md-logo" aria-label="Intel® SecL-DC">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Intel® SecL-DC
  </label>
  
    <div class="md-nav__source">
      
<a href="https://raghav19.github.io/docs" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    intel-secl/intel-secl
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Welcome to Intel® SecL-DC
      </a>
    </li>
  

    
      
      
      


  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
      
      <label class="md-nav__link" for="nav-2">
        Quick Start Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Quick Start Guide" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Quick Start Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1" checked>
      
      <label class="md-nav__link" for="nav-2-1">
        Foundational & Workload
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Foundational & Workload" data-md-level="2">
        <label class="md-nav__title" for="nav-2-1">
          <span class="md-nav__icon md-icon"></span>
          Foundational & Workload
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../pre-reqs/" class="md-nav__link">
        Pre-requisites
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../build/" class="md-nav__link">
        Build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../deploy/" class="md-nav__link">
        Deploy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../workflows/" class="md-nav__link">
        Workflows
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Appendix
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Appendix
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-behind-proxy" class="md-nav__link">
    Running behind Proxy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#git-config-sample-gitconfig" class="md-nav__link">
    Git Config Sample (~/.gitconfig)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rebuilding-repos" class="md-nav__link">
    Rebuilding Repos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-the-intel-secl-kubernetes-extensions-and-integration-hub" class="md-nav__link">
    Installing the Intel® SecL Kubernetes Extensions and Integration Hub
  </a>
  
    <nav class="md-nav" aria-label="Installing the Intel® SecL Kubernetes Extensions and Integration Hub">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploy-intel-secl-custom-controller" class="md-nav__link">
    Deploy Intel® SecL Custom Controller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-the-intel-secl-integration-hub" class="md-nav__link">
    Installing the Intel® SecL Integration Hub
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-intel-secl-extended-scheduler" class="md-nav__link">
    Deploy Intel® SecL Extended Scheduler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-kube-scheduler-to-establish-communication-with-isecl-scheduler" class="md-nav__link">
    Configuring kube-scheduler to establish communication with isecl-scheduler
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2" >
      
      <label class="md-nav__link" for="nav-2-2">
        Secure Key Caching
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Secure Key Caching" data-md-level="2">
        <label class="md-nav__title" for="nav-2-2">
          <span class="md-nav__icon md-icon"></span>
          Secure Key Caching
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../secure_key_caching/pre-reqs/" class="md-nav__link">
        Pre-requisites
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../secure_key_caching/build/" class="md-nav__link">
        Build
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../secure_key_caching/deploy/" class="md-nav__link">
        Deploy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../secure_key_caching/workflows/" class="md-nav__link">
        Workflows
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../secure_key_caching/appendix/" class="md-nav__link">
        Appendix
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      


  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        Product Guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Product Guide" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Product Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../product-guide/Product%20Guide%20-%20Intel%C2%AE%20Security%20Libraries%20-%20Datacenter%20Foundational%20Security/" class="md-nav__link">
        Intel® Security Libraries - Datacenter Foundational Security
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../product-guide/Product%20Guide%20-%20Intel%C2%AE%20Security%20Libraries%20-%20Secure%20Key%20Caching/" class="md-nav__link">
        Intel® Security Libraries - Datacenter SGX Attestation Infrastructure and Secure Key Caching
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-behind-proxy" class="md-nav__link">
    Running behind Proxy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#git-config-sample-gitconfig" class="md-nav__link">
    Git Config Sample (~/.gitconfig)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rebuilding-repos" class="md-nav__link">
    Rebuilding Repos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-the-intel-secl-kubernetes-extensions-and-integration-hub" class="md-nav__link">
    Installing the Intel® SecL Kubernetes Extensions and Integration Hub
  </a>
  
    <nav class="md-nav" aria-label="Installing the Intel® SecL Kubernetes Extensions and Integration Hub">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploy-intel-secl-custom-controller" class="md-nav__link">
    Deploy Intel® SecL Custom Controller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-the-intel-secl-integration-hub" class="md-nav__link">
    Installing the Intel® SecL Integration Hub
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-intel-secl-extended-scheduler" class="md-nav__link">
    Deploy Intel® SecL Extended Scheduler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-kube-scheduler-to-establish-communication-with-isecl-scheduler" class="md-nav__link">
    Configuring kube-scheduler to establish communication with isecl-scheduler
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="appendix">Appendix</h1>
<h3 id="running-behind-proxy">Running behind Proxy</h3>
<div class="highlight"><pre><span></span><code><span class="c1">#Set proxy in ~/.bash_profile</span>
<span class="nb">export</span> <span class="nv">http_proxy</span><span class="o">=</span>&lt;proxy-url&gt;
<span class="nb">export</span> <span class="nv">https_proxy</span><span class="o">=</span>&lt;proxy-url&gt;
<span class="nb">export</span> <span class="nv">no_proxy</span><span class="o">=</span>&lt;ip_address/hostname&gt;
</code></pre></div>
<h3 id="git-config-sample-gitconfig">Git Config Sample (~/.gitconfig)</h3>
<div class="highlight"><pre><span></span><code>[user]
        name = &lt;username&gt;
        email = &lt;email-id&gt;
[color]
        ui = auto
 [push]
        default = matching 
</code></pre></div>
<h3 id="rebuilding-repos">Rebuilding Repos</h3>
<p>In order to rebuild repos, ensure the following steps are followed as a pre-requisite</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Clean all go-mod packages</span>
rm -rf ~/go/pkg/mod/*

<span class="c1">#Navigate to specific folder where repos are built, example below</span>
<span class="nb">cd</span> /root/isec/fs
rm -rf * .repo
</code></pre></div>
<h3 id="installing-the-intel-secl-kubernetes-extensions-and-integration-hub">Installing the Intel® SecL Kubernetes Extensions and Integration Hub</h3>
<p>Intel® SecL uses Custom Resource Definitions to add the ability to base
orchestration decisions on Intel® SecL security attributes to
Kubernetes. These CRDs allow Kubernetes administrators to configure pods
to require specific security attributes so that the Kubernetes Control Plane
Node will schedule those pods only on Worker Nodes that match the
specified attributes.</p>
<p>Two CRDs are required for integration with Intel® SecL – an extension
for the Control Plane nodes, and a scheduler extension. The extensions are deployed as a Kubernetes
deployment in the <code>isecl</code> namespace.</p>
<h4 id="deploy-intel-secl-custom-controller">Deploy Intel® SecL Custom Controller</h4>
<ol>
<li>
<p>Copy <code>isecl-k8s-extensions-*.tar.gz</code> to Kubernetes Control plane machine and extract the contents</p>
<div class="highlight"><pre><span></span><code><span class="c1">#Copy</span>
scp /&lt;build_path&gt;/binaries/isecl-k8s-extensions-*.tar.gz &lt;user&gt;@&lt;k8s_master_machine&gt;:/&lt;path&gt;/

<span class="c1">#Extract</span>
tar -xvzf /&lt;path&gt;/isecl-k8s-extensions-*.tar.gz
<span class="nb">cd</span> /&lt;path&gt;/isecl-k8s-extensions/
</code></pre></div>
</li>
<li>
<p>Create <code>hostattributes.crd.isecl.intel.com</code> CRD</p>
<div class="highlight"><pre><span></span><code><span class="c1">#1.14&lt;=k8s_version&lt;=1.16</span>
kubectl apply -f yamls/crd-1.14.yaml

<span class="c1">#1.16&lt;=k8s_version&lt;=1.18</span>
kubectl apply -f yamls/crd-1.17.yaml
</code></pre></div>
</li>
<li>
<p>Check whether the CRD is created</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl get crds
</code></pre></div>
<ol>
<li>Load the <code>isecl-controller</code> docker image</li>
</ol>
<div class="highlight"><pre><span></span><code>docker load -i docker-isecl-controller-*.tar
</code></pre></div>
<ol>
<li>Deploy <code>isecl-controller</code></li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl apply -f yamls/isecl-controller.yaml
</code></pre></div>
<ol>
<li>Check whether the isecl-controller is up and running</li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl get deploy -n isecl
</code></pre></div>
<ol>
<li>Create clusterRoleBinding for ihub to get access to cluster nodes</li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl create clusterrolebinding isecl-clusterrole --clusterrole<span class="o">=</span>system:node --user<span class="o">=</span>system:serviceaccount:isecl:isecl
</code></pre></div>
<ol>
<li>Fetch token required for ihub installation</li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl get secrets -n isecl

<span class="c1">#The below token will be used for ihub installation when configured with Kubernetes Tenant</span>
kubectl describe secret default-token-&lt;name&gt; -n isecl
</code></pre></div>
<ol>
<li>Additional Optional Configurable fields for isecl-controller configuration in <code>isecl-controller.yaml</code></li>
</ol>
<table>
<thead>
<tr>
<th>Field</th>
<th>Required</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>LOG_LEVEL</td>
<td><code>Optional</code></td>
<td><code>string</code></td>
<td>INFO</td>
<td>Determines the log level</td>
</tr>
<tr>
<td>LOG_MAX_LENGTH</td>
<td><code>Optional</code></td>
<td><code>int</code></td>
<td>1500</td>
<td>Determines the maximum length of characters in a line in log file</td>
</tr>
<tr>
<td>TAG_PREFIX</td>
<td><code>Optional</code></td>
<td><code>string</code></td>
<td>isecl</td>
<td>A custom prefix which can be applied to isecl attributes that are pushed from IH. For example, if the tag-prefix is <strong>isecl.</strong> and <strong>trusted</strong> attribute in CRD becomes <strong>isecl.trusted</strong>.</td>
</tr>
<tr>
<td>TAINT_UNTRUSTED_NODES</td>
<td><code>Optional</code></td>
<td><code>string</code></td>
<td>false</td>
<td>If set to true. NoExec taint applied to the nodes for which trust status is set to false, Applicable only for HVS based attestation</td>
</tr>
</tbody>
</table>
<h4 id="installing-the-intel-secl-integration-hub">Installing the Intel® SecL Integration Hub</h4>
<ol>
<li>Copy the API Server certificate of K8s Master to machine where Integration Hub will be installed to <code>/root/</code> directory</li>
</ol>
<blockquote>
<p><strong>Note:</strong>  In most  Kubernetes distributions the Kubernetes certificate and key is normally present under <code>/etc/kubernetes/pki</code>. However this might differ in case of some specific Kubernetes distributions.</p>
</blockquote>
<ol>
<li>
<p>Update the token obtained in  Step 8 of <code>Deploy Intel® SecL Custom Controller</code> along with other relevant tenant configuration options in <code>ihub.env</code></p>
</li>
<li>
<p>Install Integration Hub</p>
</li>
<li>
<p>Copy the <code>/etc/ihub/ihub_public_key.pem</code> to Kubernetes Master machine to <code>/&lt;path&gt;/secrets/</code> directory</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1">#On K8s-Master machine</span>
mkdir -p /&lt;path&gt;/secrets

<span class="c1">#On IHUB machine, copy</span>
scp /etc/ihub/ihub_public_key.pem &lt;user&gt;@&lt;k8s_master_machine&gt;:/&lt;path&gt;/secrets/hvs_ihub_public_key.pem
</code></pre></div>
<h4 id="deploy-intel-secl-extended-scheduler">Deploy Intel® SecL Extended Scheduler</h4>
<ol>
<li>Install <code>cfssl</code> and <code>cfssljson</code> on Kubernetes Control Plane</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1">#Install wget</span>
dnf install wget -y

<span class="c1">#Download cfssl to /usr/local/bin/</span>
wget -O /usr/local/bin/cfssl http://pkg.cfssl.org/R1.2/cfssl_linux-amd64
chmod +x /usr/local/bin/cfssl

<span class="c1">#Download cfssljson to /usr/local/bin</span>
wget -O /usr/local/bin/cfssljson http://pkg.cfssl.org/R1.2/cfssljson_linux-amd64
chmod +x /usr/local/bin/cfssljson
</code></pre></div>
<ol>
<li>Create TLS key-pair for <code>isecl-scheduler</code> service which is signed by Kubernetes <code>apiserver.crt</code></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> /&lt;path&gt;/isecl-k8s-extensions/
chmod +x create_k8s_extsched_cert.sh

<span class="c1">#Set K8s_MASTER_IP,HOSTNAME</span>
<span class="nb">export</span> <span class="nv">MASTER_IP</span><span class="o">=</span>&lt;k8s_machine_ip&gt;
<span class="nb">export</span> <span class="nv">HOSTNAME</span><span class="o">=</span>&lt;k8s_machine_hostname&gt;

<span class="c1">#Create TLS key-pair</span>
./create_k8s_extsched_cert.sh -n <span class="s2">&quot;K8S Extended Scheduler&quot;</span> -s <span class="s2">&quot;</span><span class="nv">$MASTER_IP</span><span class="s2">&quot;</span>,<span class="s2">&quot;</span><span class="nv">$HOSTNAME</span><span class="s2">&quot;</span> -c &lt;k8s_ca_authority_cert&gt; -k &lt;k8s_ca_authority_key&gt;
</code></pre></div>
<blockquote>
<p><strong>Note:</strong>  In most  Kubernetes distributions the Kubernetes certificate and key is normally present under <code>/etc/kubernetes/pki</code>. However this might differ in case of some specific Kubernetes distributions.</p>
</blockquote>
<ol>
<li>Copy the TLS key-pair generated to <code>/&lt;path&gt;/secrets/</code> directory</li>
</ol>
<div class="highlight"><pre><span></span><code>cp /&lt;path&gt;/isecl-k8s-extensions/server.key /&lt;path&gt;/secrets/
cp /&lt;path&gt;/isecl-k8s-extensions/server.crt /&lt;path&gt;/secrets/
</code></pre></div>
<ol>
<li>Load the <code>isecl-scheduler</code> docker image</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> /&lt;path&gt;/isecl-k8s-extensions/
docker load -i docker-isecl-scheduler-*.tar
</code></pre></div>
<ol>
<li>Create scheduler-secret for isecl-scheduler</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> /&lt;path&gt;/
kubectl create secret generic scheduler-certs --namespace isecl --from-file<span class="o">=</span>secrets
</code></pre></div>
<ol>
<li>The <code>isecl-scheduler.yaml</code> file includes support for both SGX and Workload Security put together. For only working with Workload Security scenarios , the following line needs to be made empty in the yaml file. The scheduler and controller yaml files are located under <code>/&lt;path&gt;/isecl-k8s-extensions/yamls</code></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SGX_IHUB_PUBLIC_KEY_PATH</span>
  <span class="nt">value</span><span class="p">:</span> <span class="s">&quot;&quot;</span>
</code></pre></div>
<ol>
<li>Deploy <code>isecl-scheduler</code></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> /&lt;path&gt;/isecl-k8s-extensions/
kubectl apply -f yamls/isecl-scheduler.yaml      
</code></pre></div>
<ol>
<li>Check whether the <code>isecl-scheduler</code> is up and running</li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl get deploy -n isecl
</code></pre></div>
<ol>
<li>Additional optional fields for isecl-scheduler configuration in <code>isecl-scheduler.yaml</code></li>
</ol>
<table>
<thead>
<tr>
<th>Field</th>
<th>Required</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>LOG_LEVEL</td>
<td><code>Optional</code></td>
<td><code>string</code></td>
<td>INFO</td>
<td>Determines the log level</td>
</tr>
<tr>
<td>LOG_MAX_LENGTH</td>
<td><code>Optional</code></td>
<td><code>int</code></td>
<td>1500</td>
<td>Determines the maximum length of characters in a line in log file</td>
</tr>
<tr>
<td>TAG_PREFIX</td>
<td><code>Optional</code></td>
<td><code>string</code></td>
<td>isecl.</td>
<td>A custom prefix which can be applied to isecl attributes that are pushed from IH. For example, if the tag-prefix is <strong><em>*isecl.*</em></strong> and <strong><em>*trusted*</em></strong> attribute in CRD becomes <strong><em>*isecl.trusted*</em></strong>.</td>
</tr>
<tr>
<td>PORT</td>
<td><code>Optional</code></td>
<td><code>int</code></td>
<td>8888</td>
<td>ISecl scheduler service port</td>
</tr>
<tr>
<td>HVS_IHUB_PUBLIC_KEY_PATH</td>
<td><code>Required</code></td>
<td><code>string</code></td>
<td></td>
<td>Required for IHub with HVS Attestation</td>
</tr>
<tr>
<td>SGX_IHUB_PUBLIC_KEY_PATH</td>
<td><code>Required</code></td>
<td><code>string</code></td>
<td></td>
<td>Required for IHub with SGX Attestation</td>
</tr>
<tr>
<td>TLS_CERT_PATH</td>
<td><code>Required</code></td>
<td><code>string</code></td>
<td></td>
<td>Path of tls certificate signed by kubernetes CA</td>
</tr>
<tr>
<td>TLS_KEY_PATH</td>
<td><code>Required</code></td>
<td><code>string</code></td>
<td></td>
<td>Path of tls key</td>
</tr>
</tbody>
</table>
<h4 id="configuring-kube-scheduler-to-establish-communication-with-isecl-scheduler">Configuring kube-scheduler to establish communication with isecl-scheduler</h4>
<blockquote>
<p><strong>Note:</strong> The below is a sample when using <code>kubeadm</code> as the Kubernetes distribution, the scheduler configuration files would be different for any other Kubernetes distributions being used.</p>
</blockquote>
<ol>
<li>
<p>Add a mount path to the
    <code>/etc/kubernetes/manifests/kube-scheduler.yaml</code> file for the Intel
    SecL scheduler extension:</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span> <span class="nt">mountPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/&lt;path&gt;/isecl-k8s-extensions/</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">extendedsched</span>
  <span class="nt">readOnly</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</li>
<li>
<p>Add a volume path to the
   <code>/etc/kubernetes/manifests/kube-scheduler.yaml</code> file for the Intel
   SecL scheduler extension:</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span> <span class="nt">hostPath</span><span class="p">:</span>
    <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/&lt;path&gt;/isecl-k8s-extensions/</span>
    <span class="nt">type</span><span class="p">:</span> <span class="s">&quot;&quot;</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">extendedsched</span>
</code></pre></div>
<ol>
<li>Add <code>policy-config-file</code> path in the
   <code>/etc/kubernetes/manifests/kube-scheduler.yaml</code> file under <code>command</code> section:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span> <span class="nt">command</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">kube-scheduler</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--policy-config-file=/&lt;path&gt;/isecl-k8s-extensions/scheduler-policy.json</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--bind-address=127.0.0.1</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--kubeconfig=/etc/kubernetes/scheduler.conf</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">--leader-elect=true</span>
</code></pre></div>
<ol>
<li>Restart kubelet </li>
</ol>
<div class="highlight"><pre><span></span><code>systemctl restart kubelet
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../workflows/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Workflows
              </div>
            </div>
          </a>
        
        
          <a href="../../secure_key_caching/pre-reqs/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Pre-requisites
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../../../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>